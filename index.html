<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Diamond Grade Calculator</title>
<style>
    body {
        background-image: linear-gradient(#FFFFFF,#13b9e8);
        
        /* Additional styling starts below. */
        font-family: 'Lexend Deca', sans-serif;
        width: 700px; 
        margin: auto;
        color: #000000;
}

    .grade-table-class {
        margin-bottom: 20px;
    }
    table {
        border-collapse: collapse;
        width: 50%;
    }
    th, td {
        border: 1px solid #dddddd;
        text-align: left;
        padding: 8px;
    }
    th {
        background-color: #6953be;
    }
</style>
</head>
<body>
<h2>Diamond Grade Calculator</h2>
<p>Welcome to the Diamond Grade Calculator! Use this tool to figure out your grade in your class and see how to properly allocate your time!</p>

<div class="grade-table-class">
    <h3>Current Grade Calculator</h3>
    <p>Input the number of graded assignments (homework, midterms, final), what grade you recieved (in percentage) and how they are weighed in the class</p>
    <table class="gradeTable">
        <tr>
            <th>Assignment Name</th>
            <th>Grade (%)</th>
            <th>Weight (%)</th>
        </tr>
        <tr>
            <td><input type="text" class="assignment-name"></td>
            <td><input type="number" class="grade" min="0" max="100"></td>
            <td><input type="number" class="weight" min="0" max="100"></td>
        </tr>
    </table>
    <button onclick="addRow(this.parentNode)">Add Assignment</button>
    <button onclick="deleteRow()">Delete Row</button>
    <button onclick="calculateTotalGrade(this.parentNode)">Calculate</button>
    <br><br>
    Total Grade: <span id="totalGrade"></span>
</div>

<script>
    function calculateTotalGrade(container) {
        //From rapidtables: The weighted grade is equal to the sum of the product of the weights (w) in percent (%) times the grade (g):
        //Weighted grade = w1×g1+ w2×g2+ w3×g3+...
        const table = container.querySelector(".gradeTable");
        const rows = table.querySelectorAll("tr");
        // const grades = [];
        // const weights = [];
        let totalGrade = 0;
        let totalWeight = 0;
        for(let i = 1; i < rows.length; i++){
            const gradeIn = rows[i].querySelector(".grade");
            const weightIn = rows[i].querySelector(".weight");
            const g = parseFloat(gradeIn.value);
            const w = parseFloat(weightIn.value);
            if(gradeIn.value == '' || weightIn.value == ''){
                alert("Please insert grade and weight values for all assignments!");
                return;
            }
            if(isNaN(g) || isNaN(w) || g < 0 || g > 100 || w < 0 || w > 100){
                alert("Please only insert numbers between 0-100");
                return;
            }
            totalGrade += (g * w);
            totalWeight += w;
        }
        if(totalWeight === 0){
            alert("The sum of your inputted weights is 0 ");
            return;
        }

        const calcGrade = (totalGrade/totalWeight).toFixed(2);
        document.getElementById("totalGrade").innerText = calcGrade + "%";
    }

    function addRow(container) {
        const table = container.querySelector(".gradeTable");
        const newRow = table.insertRow(table.rows.length);
        const cells = ['assignment-name', 'grade', 'weight'];
        cells.forEach(cell => {
            const newCell = newRow.insertCell();
            const input = document.createElement("input");
            input.setAttribute("type", cell === "grade" || cell === "weight" ? "number" : "text");
            input.setAttribute("class", cell);
            if (cell === "grade" || cell === "weight") {
                input.setAttribute("min", "0");
                input.setAttribute("max", "100");
        
            }
            newCell.appendChild(input);
        });
        
    }

    function deleteRow() {
        const table = document.querySelector(".gradeTable");
        const rowCount = table.rows.length;
        if (rowCount > 2) {
            table.deleteRow(rowCount - 1); // Delete the last row
        } else {
            alert("Cannot delete row. At least one row must remain.");
        }
    }
    
</script>
</body>
</html>
